<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Leave-One-Out fit of elastic nets for Functional Connectivity data with nested crossvalidation — FCnetLOO • FCnet</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Leave-One-Out fit of elastic nets for Functional Connectivity data with nested crossvalidation — FCnetLOO" />
<meta property="og:description" content="This function is a wrapper around glmnet::glmnet() as called from
FCnet::cv_FCnet(). For extended documentation,
the readers are encouraged to consult the original source of glmnet::glmnet()
and its vignette. glmnet::glmnet() fits a robust linear model through
penalized maximum likelihood computed via the lasso or elastic net
regularization path.
FCnetLOO() requires two objects at minimum: y is a vector or data.frame
with exactly one column, corresponding to the (behavioral) score to predict; x
is a data.frame or a list of lists with an entry named &quot;Weights&quot;,
which includes the independent variables. x can be - and is meant to be -
one object created by reduce_featuresFC(), but this is not strictly necessary.
The best model and hyperparameters are retrieved in inner loops through cv_FCnet();
details of the crossvalidation procedures can be passed as ... arguments to
FCnetLOO() if necessary.
A call to FCnetLOO() returns a list including goodness of fit measures
for the outer loop, a data.frame including coefficients for all nested models,
vectors of crossvalidated parameters, and predicted scores.
Note that dependent variables are scaled by default through scale_y.
The ParallelLOO option is recommended for speed. In order to use parallel
computing, future.apply must be installed, your machine should have
multiple cores available, and parallel computing should be prompted by
the user (e.g. via plan(multisession)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FCnet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.9.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FCnet_overview_of_package.html">FCnet_overview_of_package</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Leave-One-Out fit of elastic nets for Functional Connectivity data with nested crossvalidation</h1>
    
    <div class="hidden name"><code>FCnetLOO.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrapper around <code><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet::glmnet()</a></code> as called from
<code><a href='cv_FCnet.html'>FCnet::cv_FCnet()</a></code>. For extended documentation,
the readers are encouraged to consult the original source of <code><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet::glmnet()</a></code>
and its vignette. <code><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet::glmnet()</a></code> fits a robust linear model through
penalized maximum likelihood computed via the lasso or elastic net
regularization path.
<code>FCnetLOO()</code> requires two objects at minimum: <code>y</code> is a vector or data.frame
with exactly one column, corresponding to the (behavioral) score to predict; <code>x</code>
is a data.frame or a list of lists with an entry named "Weights",
which includes the independent variables. <code>x</code> can be - and is meant to be -
one object created by <code><a href='reduce_featuresFC.html'>reduce_featuresFC()</a></code>, but this is not strictly necessary.
The best model and hyperparameters are retrieved in inner loops through <code><a href='cv_FCnet.html'>cv_FCnet()</a></code>;
details of the crossvalidation procedures can be passed as <code>...</code> arguments to
<code>FCnetLOO()</code> if necessary.
A call to <code>FCnetLOO()</code> returns a list including goodness of fit measures
for the outer loop, a data.frame including coefficients for all nested models,
vectors of crossvalidated parameters, and predicted scores.
Note that dependent variables are scaled by default through <code>scale_y</code>.
The <code>ParallelLOO</code> option is recommended for speed. In order to use parallel
computing, <code>future.apply</code> must be installed, your machine should have
multiple cores available, and parallel computing should be prompted by
the user (e.g. via <code>plan(multisession</code>).</p>
    </div>

    <pre class="usage"><span class='fu'>FCnetLOO</span><span class='op'>(</span>
  <span class='va'>y</span>,
  <span class='va'>x</span>,
  alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, by <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>,
  lambda <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>5</span>, length.out <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>,
  cv_Ncomp <span class='op'>=</span> <span class='cn'>NULL</span>,
  cv_Ncomp_method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"order"</span>, <span class='st'>"R"</span><span class='op'>)</span>,
  parallelLOO <span class='op'>=</span> <span class='cn'>F</span>,
  scale_y <span class='op'>=</span> <span class='cn'>T</span>,
  scale_x <span class='op'>=</span> <span class='cn'>T</span>,
  family <span class='op'>=</span> <span class='fu'><a href='optionsFCnet.html'>optionsFCnet</a></span><span class='op'>(</span><span class='st'>"family"</span><span class='op'>)</span>,
  type.measure <span class='op'>=</span> <span class='fu'><a href='optionsFCnet.html'>optionsFCnet</a></span><span class='op'>(</span><span class='st'>"cv.type.measure"</span><span class='op'>)</span>,
  intercept <span class='op'>=</span> <span class='fu'><a href='optionsFCnet.html'>optionsFCnet</a></span><span class='op'>(</span><span class='st'>"intercept"</span><span class='op'>)</span>,
  standardize <span class='op'>=</span> <span class='fu'><a href='optionsFCnet.html'>optionsFCnet</a></span><span class='op'>(</span><span class='st'>"standardize"</span><span class='op'>)</span>,
  thresh <span class='op'>=</span> <span class='fu'><a href='optionsFCnet.html'>optionsFCnet</a></span><span class='op'>(</span><span class='st'>"thresh"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>The dependent variable, typically behavioral scores to predict.
This can be a vector or a single data.frame column.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>The independent variables, typically neural measures that have
been already summarised through data reduction techniques
(e.g. ICA, PCA): an object created by <code><a href='reduce_featuresFC.html'>reduce_featuresFC()</a></code> will do. If such
an object is passed to this function, the "Weights" slot is taken as x.
A list can be passed to this function: in this case the function needs an
entry named "Weights". Otherwise, a data.frame can be passed to x.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Value(s) that bias the elastic net toward ridge regression
(alpha== 0) or LASSO regression (alpha== 1). If a vector of alpha values
is supplied, the value is optimized through nested crossvalidation.
It defaults to a vector ranging from 0 to 1 with steps of 0.1.
The crossvalidated alpha is returned.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Regularization parameter for the regression,
see <code><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet::glmnet()</a></code>. Lambda must be a vector with length&gt;1.
When a vector of lambda values is supplied, the value of lambda
is optimized through internal nested crossvalidation. It defaults to a vector
ranging from 10^-5 to 10^5 with 200 values in logarithmic steps.
The crossvalidated optimal lambda is returned.</p></td>
    </tr>
    <tr>
      <th>cv_Ncomp</th>
      <td><p>Whether to crossvalidate the number of components or not.
It defaults to NULL, but a vector can be supplied specifing the number (range) of
components to test in the inner loops.</p></td>
    </tr>
    <tr>
      <th>cv_Ncomp_method</th>
      <td><p>Whether the number of components to optimize means
components are ordered (e.g. according to the explained variance of neuroimaging
data) or - somehow experimental - whether to use the N best components
ranked according to their relationship (in the context of a
univariate (g)lm) with y.</p></td>
    </tr>
    <tr>
      <th>parallelLOO</th>
      <td><p>If TRUE - recommended, but not the default - uses
<code><a href='https://future.apply.futureverse.org/reference/future_lapply.html'>future.apply::future_lapply()</a></code> for the outer loops: <code>future.apply</code> must be
installed, the machine should have multiple cores available for use,
and threads should be defined explicitly beforehand by the user
(e.g. by calling <code>plan(multisession)</code>).</p></td>
    </tr>
    <tr>
      <th>scale_y</th>
      <td><p>Whether y should be scaled prior to fit. Default, TRUE, scales and center y with
<code><a href='https://rdrr.io/r/base/scale.html'>scale()</a></code>.</p></td>
    </tr>
    <tr>
      <th>scale_x</th>
      <td><p>Whether x should be scaled prior to fit. Default, TRUE, subtracts
the mean matrix value and divides each entry for the matrix variance.
Beware that this adds to <code>optionsFCnet("standardize")</code>.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Defaults to "gaussian." Experimental support for "binomial" on the way.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>whether to fit (TRUE) or not (FALSE) an intercept to the model.</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>Whether x must be standardized.</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>Threshold for glmnet to stop converging to the solution.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters passed to <code><a href='https://rdrr.io/pkg/glmnetUtils/man/cva.glmnet.html'>glmnetUtils::cva.glmnet()</a></code> or
<code><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet::glmnet()</a></code>.</p></td>
    </tr>
    <tr>
      <th>cv.type.measure</th>
      <td><p>The measure to minimize in crossvalidation inner loops.
Differently from <code><a href='https://rdrr.io/pkg/glmnetUtils/man/cva.glmnet.html'>glmnetUtils::cva.glmnet()</a></code> the default is the mean absolute error.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Goodness of fit statistics for the outer loops, as well as LOO predictions.
Crossvalidated best alpha and lambda values for the inner loops as well as
all inner models' coefficients combined..</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Elvio Blini, Michele De Filippo De Grazia, Alberto Testolin, Marco Zorzi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


